
CFLAGS_DBUS = $(shell pkg-config --cflags --libs dbus-1)
CFLAGS_DBUS_GLIB = $(shell pkg-config --cflags --libs dbus-glib-1)
CFLAGS_GIO  = $(shell pkg-config --cflags --libs gio-2.0)

CFLAGS = -g -Wall -Werror


all: dbus-exploit

dbus-exploit: exploit.c 
	gcc $< -o $@ agent.c agent.h $(CFLAGS_GIO) $(CFLAGS) $(CFLAGS_DBUS) $(CFLAGS_DBUS_GLIB) -Werror=uninitialized -Werror=return-type -Werror=incompatible-pointer-types -Werror=format-security



clean:
	rm dbus-exploit


.PHONY: all clean